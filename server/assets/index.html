<!-- server/assets/index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>motiondetector</title>
  <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body>
  <header>
    <h1>motiondetector</h1>
    <div class="actions">
      <div class="toggle control-group" title="Change grid at runtime and overlay labels">
        <span>Grid</span>
        <input id="gridRows" type="number" min="1" style="width:56px" />
        <span>x</span>
        <input id="gridCols" type="number" min="1" style="width:56px" />
        <button id="applyGrid">Apply</button>
        <label class="inline-check" title="Show numbers on the selector overlay grid">
          <input id="toggleTileNumbers" type="checkbox" />
          <span>Tile numbers</span>
        </label>
      </div>

      <div class="toggle control-group" title="Grid position and size in pixels">
        <div class="rowline">
          <span>X</span><input id="regionX" type="number" style="width:76px" />
          <span>Y</span><input id="regionY" type="number" style="width:76px" />
          <button id="nudgeUp" class="btn-mini">↑</button>
          <button id="nudgeDown" class="btn-mini">↓</button>
          <button id="nudgeLeft" class="btn-mini">←</button>
          <button id="nudgeRight" class="btn-mini">→</button>
        </div>
        <div class="rowline">
          <span>W</span><input id="regionW" type="number" min="1" style="width:76px" />
          <button id="wPlus" class="btn-mini">W+</button>
          <button id="wMinus" class="btn-mini">W-</button>
          <span>H</span><input id="regionH" type="number" min="1" style="width:76px" />
          <button id="hPlus" class="btn-mini">H+</button>
          <button id="hMinus" class="btn-mini">H-</button>
          <button id="applyRegion">Apply</button>
        </div>
      </div>

      <label class="toggle" title="Show current detector state in the selector chrome">
        <input id="toggleOverlayState" type="checkbox" />
        <span>Overlay state</span>
      </label>

      <button id="quitBtn">Quit</button>
    </div>
    <div class="subtle" id="monitorInfo">monitor: —</div>
  </header>

  <div class="grid dashboard-grid">
    <section class="panel panel-heatmap">
      <h2><span>Tiles heatmap (0 → 1)</span></h2>
      <div class="heatwrap">
        <canvas id="tilesHeatmap" width="900" height="540" aria-label="Tiles heatmap (click tile to disable/enable)"></canvas>
      </div>
      <div class="subtle" id="gridLabel" style="margin-top:10px;">grid: —</div>
      <div class="subtle" style="margin-top:6px;">Click a tile to disable/enable it (disabled tiles are excluded from measurements).</div>
    </section>

    <section class="panel panel-json">
      <h2>
        <span>Status JSON</span>
        <div style="display:flex;align-items:center;gap:8px;">
          <span class="subtle" id="tsLabel">—</span>
          <button id="copyJson" class="btn-mini">Copy JSON</button>
        </div>
      </h2>

      <div class="pillrow">
        <span class="pill" id="pillVideo">video: —</span>
        <span class="pill" id="pillMean">motion_mean: —</span>
        <span class="pill" id="pillOverall">overall: —</span>
      </div>

      <pre id="jsonBox">{}</pre>
    </section>

    <section class="panel panel-motion">
      <h2><span>Motion mean + peak (last {{HISTORY_SECONDS}}s)</span></h2>
      <div class="chartwrap">
        <canvas id="chart" width="900" height="540"></canvas>
      </div>
    </section>

    <section class="panel panel-audio">
      <h2><span>Audio mean + peak % (last {{HISTORY_SECONDS}}s)</span></h2>
      <div class="chartwrap">
        <canvas id="audioChart" width="900" height="540"></canvas>
      </div>
    </section>
  </div>

  <script type="module" src="/assets/app.js"></script>
</body>
</html>
